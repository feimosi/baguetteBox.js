!function(root,factory){"use strict";"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?module.exports=factory():root.baguetteBox=factory()}(this,function(){"use strict";var overlay,slider,previousButton,nextButton,closeButton,leftArrow='<svg width="44" height="60"><polyline points="30 10 10 30 30 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',rightArrow='<svg width="44" height="60"><polyline points="14 10 34 30 14 50" stroke="rgba(255,255,255,0.5)" stroke-width="4"stroke-linecap="butt" fill="none" stroke-linejoin="round"/></svg>',closeX='<svg width="30" height="30"><g stroke="rgb(160,160,160)" stroke-width="4"><line x1="5" y1="5" x2="25" y2="25"/><line x1="5" y1="25" x2="25" y2="5"/></g></svg>',options={},defaults={captions:!0,buttons:"auto",fullScreen:!1,noScrollbars:!1,bodyClass:"baguetteBox-open",titleTag:!1,async:!1,preload:2,animation:"slideIn",afterShow:null,afterHide:null,onChange:null,overlayBackgroundColor:"rgba(0,0,0,.8)",dblTrigger:!1,singleClickCallBack:function(){}},supports={},currentGallery=[],currentIndex=0,isOverlayVisible=!1,touch={},touchFlag=!1,regex=/.+\.(gif|jpe?g|png|webp)/i,data={},imagesElements=[],documentLastFocus=null,dblTrigger=!1,singleClickCallBack=function(){},overlayClickHandler=function(event){-1!==event.target.id.indexOf("baguette-img")&&hideOverlay()},previousButtonClickHandler=function(event){event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,showPreviousImage()},nextButtonClickHandler=function(event){event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,showNextImage()},closeButtonClickHandler=function(event){event.stopPropagation?event.stopPropagation():event.cancelBubble=!0,hideOverlay()},touchstartHandler=function(event){touch.count++,1<touch.count&&(touch.multitouch=!0),touch.startX=event.changedTouches[0].pageX,touch.startY=event.changedTouches[0].pageY},touchmoveHandler=function(touchEvent){touchFlag||touch.multitouch||(touchEvent.preventDefault?touchEvent.preventDefault():touchEvent.returnValue=!1,40<(touchEvent=touchEvent.touches[0]||touchEvent.changedTouches[0]).pageX-touch.startX?(touchFlag=!0,showPreviousImage()):touchEvent.pageX-touch.startX<-40?(touchFlag=!0,showNextImage()):100<touch.startY-touchEvent.pageY&&hideOverlay())},touchendHandler=function(){touch.count--,touch.count<=0&&(touch.multitouch=!1),touchFlag=!1},contextmenuHandler=function(){touchendHandler()},trapFocusInsideOverlay=function(event){"block"===overlay.style.display&&overlay.contains&&!overlay.contains(event.target)&&(event.stopPropagation(),initFocus())};function removeFromCache(selector){var galleries;data.hasOwnProperty(selector)&&(galleries=data[selector].galleries,[].forEach.call(galleries,function(gallery){[].forEach.call(gallery,function(imageItem){unbind(imageItem.imageElement,"click",imageItem.eventHandler)}),currentGallery===gallery&&(currentGallery=[])}),delete data[selector])}function keyDownHandler(event){switch(event.keyCode){case 37:showPreviousImage();break;case 39:showNextImage();break;case 27:hideOverlay();break;case 36:!function(event){event&&event.preventDefault();show(0)}(event);break;case 35:!function(event){event&&event.preventDefault();show(currentGallery.length-1)}(event)}}function prepareOverlay(gallery,userOptions){if(currentGallery!==gallery){for(currentGallery=gallery,function(newOptions){newOptions=newOptions||{};for(var item in defaults)options[item]=defaults[item],void 0!==newOptions[item]&&(options[item]=newOptions[item]);slider.style.transition=slider.style.webkitTransition="fadeIn"===options.animation?"opacity .4s ease":"slideIn"===options.animation?"":"none","auto"===options.buttons&&("ontouchstart"in window||1===currentGallery.length)&&(options.buttons=!1);previousButton.style.display=nextButton.style.display=options.buttons?"":"none";try{overlay.style.backgroundColor=options.overlayBackgroundColor}catch(e){}}(userOptions);slider.firstChild;)slider.removeChild(slider.firstChild);for(var fullImage,imagesFiguresIds=[],imagesCaptionsIds=[],i=imagesElements.length=0;i<gallery.length;i++)(fullImage=create("div")).className="full-image",fullImage.id="baguette-img-"+i,imagesElements.push(fullImage),imagesFiguresIds.push("baguetteBox-figure-"+i),imagesCaptionsIds.push("baguetteBox-figcaption-"+i),slider.appendChild(imagesElements[i]);overlay.setAttribute("aria-labelledby",imagesFiguresIds.join(" ")),overlay.setAttribute("aria-describedby",imagesCaptionsIds.join(" "))}}function showOverlay(chosenImageIndex){options.noScrollbars&&(document.documentElement.style.overflowY="hidden",document.body.style.overflowY="scroll"),"block"!==overlay.style.display&&(bind(document,"keydown",keyDownHandler),touch={count:0,startX:null,startY:null},loadImage(currentIndex=chosenImageIndex,function(){preloadNext(currentIndex),preloadPrev(currentIndex)}),updateOffset(),overlay.style.display="block",options.fullScreen&&(overlay.requestFullscreen?overlay.requestFullscreen():overlay.webkitRequestFullscreen?overlay.webkitRequestFullscreen():overlay.mozRequestFullScreen&&overlay.mozRequestFullScreen()),setTimeout(function(){overlay.className="visible",options.bodyClass&&document.body.classList&&document.body.classList.add(options.bodyClass),options.afterShow&&options.afterShow()},50),options.onChange&&options.onChange(currentIndex,imagesElements.length),documentLastFocus=document.activeElement,initFocus(),isOverlayVisible=!0)}function initFocus(){(options.buttons?previousButton:closeButton).focus()}function hideOverlay(){options.noScrollbars&&(document.documentElement.style.overflowY="auto",document.body.style.overflowY="auto"),"none"!==overlay.style.display&&(unbind(document,"keydown",keyDownHandler),overlay.className="",setTimeout(function(){overlay.style.display="none",document.fullscreen&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),options.bodyClass&&document.body.classList&&document.body.classList.remove(options.bodyClass),options.afterHide&&options.afterHide(),documentLastFocus&&documentLastFocus.focus(),isOverlayVisible=!1},500))}function loadImage(index,callback){var thumbnailElement,imageCaption,figure,figcaption,image=imagesElements[index],imageSrc=currentGallery[index];void 0!==image&&void 0!==imageSrc&&(image.getElementsByTagName("img")[0]?callback&&callback():(thumbnailElement=(figcaption=imageSrc.imageElement).getElementsByTagName("img")[0],imageCaption="function"==typeof options.captions?options.captions.call(currentGallery,figcaption):figcaption.getAttribute("data-caption")||figcaption.title,imageSrc=function(image){var result;result=dblTrigger?image.getAttribute("bagDblClick"):image.getAttribute("bagClick");if(image.dataset){var item,srcs=[];for(item in image.dataset)"at-"!==item.substring(0,3)||isNaN(item.substring(3))||(srcs[item.replace("at-","")]=image.dataset[item]);for(var keys=Object.keys(srcs).sort(function(a,b){return parseInt(a,10)<parseInt(b,10)?-1:1}),width=window.innerWidth*window.devicePixelRatio,i=0;i<keys.length-1&&keys[i]<width;)i++;result=srcs[keys[i]]||result}return result}(figcaption),(figure=create("figure")).id="baguetteBox-figure-"+index,figure.innerHTML='<div class="baguetteBox-spinner"><div class="baguetteBox-double-bounce1"></div><div class="baguetteBox-double-bounce2"></div></div>',options.captions&&imageCaption&&((figcaption=create("figcaption")).id="baguetteBox-figcaption-"+index,figcaption.innerHTML=imageCaption,figure.appendChild(figcaption)),image.appendChild(figure),(image=create("img")).onload=function(){var spinner=document.querySelector("#baguette-img-"+index+" .baguetteBox-spinner");figure.removeChild(spinner),!options.async&&callback&&callback()},image.setAttribute("src",imageSrc),image.alt=thumbnailElement&&thumbnailElement.alt||"",options.titleTag&&imageCaption&&(image.title=imageCaption),figure.appendChild(image),options.async&&callback&&callback()))}function showNextImage(){return show(currentIndex+1)}function showPreviousImage(){return show(currentIndex-1)}function show(index,gallery){return!isOverlayVisible&&0<=index&&index<gallery.length?(prepareOverlay(gallery,options),showOverlay(index),!0):index<0?(options.animation&&bounceAnimation("left"),!1):index>=imagesElements.length?(options.animation&&bounceAnimation("right"),!1):(loadImage(currentIndex=index,function(){preloadNext(currentIndex),preloadPrev(currentIndex)}),updateOffset(),options.onChange&&options.onChange(currentIndex,imagesElements.length),!0)}function bounceAnimation(direction){slider.className="bounce-from-"+direction,setTimeout(function(){slider.className=""},400)}function updateOffset(){var offset=100*-currentIndex+"%";"fadeIn"===options.animation?(slider.style.opacity=0,setTimeout(function(){supports.transforms?slider.style.transform=slider.style.webkitTransform="translate3d("+offset+",0,0)":slider.style.left=offset,slider.style.opacity=1},400)):supports.transforms?slider.style.transform=slider.style.webkitTransform="translate3d("+offset+",0,0)":slider.style.left=offset}function preloadNext(index){index-currentIndex>=options.preload||loadImage(index+1,function(){preloadNext(index+1)})}function preloadPrev(index){currentIndex-index>=options.preload||loadImage(index-1,function(){preloadPrev(index-1)})}function bind(element,event,callback,options){element.addEventListener?element.addEventListener(event,callback,options):element.attachEvent("on"+event,function(event){(event=event||window.event).target=event.target||event.srcElement,callback(event)})}function unbind(element,event,callback,options){element.removeEventListener?element.removeEventListener(event,callback,options):element.detachEvent("on"+event,callback)}function getByID(id){return document.getElementById(id)}function create(element){return document.createElement(element)}return[].forEach||(Array.prototype.forEach=function(callback,thisArg){for(var i=0;i<this.length;i++)callback.call(thisArg,this[i],i,this)}),[].filter||(Array.prototype.filter=function(a,b,c,d,e){for(c=this,d=[],e=0;e<c.length;e++)a.call(b,c[e],e,c)&&d.push(c[e]);return d}),{run:function(selector,userOptions){var div;return supports.transforms=void 0!==(div=create("div")).style.perspective||void 0!==div.style.webkitPerspective,supports.svg=function(){var div=create("div");return div.innerHTML="<svg/>","http://www.w3.org/2000/svg"===(div.firstChild&&div.firstChild.namespaceURI)}(),supports.passiveEvents=function(){var passiveEvents=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){passiveEvents=!0}});window.addEventListener("test",null,opts)}catch(e){}return passiveEvents}(),(overlay=getByID("baguetteBox-overlay"))?(slider=getByID("baguetteBox-slider"),previousButton=getByID("previous-button"),nextButton=getByID("next-button"),closeButton=getByID("close-button")):((overlay=create("div")).setAttribute("role","dialog"),overlay.id="baguetteBox-overlay",document.getElementsByTagName("body")[0].appendChild(overlay),(slider=create("div")).id="baguetteBox-slider",overlay.appendChild(slider),(previousButton=create("button")).setAttribute("type","button"),previousButton.id="previous-button",previousButton.setAttribute("aria-label","Previous"),previousButton.innerHTML=supports.svg?leftArrow:"&lt;",overlay.appendChild(previousButton),(nextButton=create("button")).setAttribute("type","button"),nextButton.id="next-button",nextButton.setAttribute("aria-label","Next"),nextButton.innerHTML=supports.svg?rightArrow:"&gt;",overlay.appendChild(nextButton),(closeButton=create("button")).setAttribute("type","button"),closeButton.id="close-button",closeButton.setAttribute("aria-label","Close"),closeButton.innerHTML=supports.svg?closeX:"&times;",overlay.appendChild(closeButton),previousButton.className=nextButton.className=closeButton.className="baguetteBox-button",function(){var passiveEvent=supports.passiveEvents?{passive:!1}:null,nonPassiveEvent=supports.passiveEvents?{passive:!0}:null;bind(overlay,"click",overlayClickHandler),bind(previousButton,"click",previousButtonClickHandler),bind(nextButton,"click",nextButtonClickHandler),bind(closeButton,"click",closeButtonClickHandler),bind(slider,"contextmenu",contextmenuHandler),bind(overlay,"touchstart",touchstartHandler,nonPassiveEvent),bind(overlay,"touchmove",touchmoveHandler,passiveEvent),bind(overlay,"touchend",touchendHandler),bind(document,"focus",trapFocusInsideOverlay,!0)}()),removeFromCache(selector),dblTrigger=userOptions.dblTrigger,null!=userOptions.singleClickCallBack&&(singleClickCallBack=userOptions.singleClickCallBack),function(selector,userOptions){var galleryNodeList=document.querySelectorAll(selector),selectorData={galleries:[],nodeList:galleryNodeList};return data[selector]=selectorData,[].forEach.call(galleryNodeList,function(galleryElement){userOptions&&userOptions.filter&&(regex=userOptions.filter);var tagsNodeList=[],tagsNodeList="A"===galleryElement.tagName?[galleryElement]:galleryElement.getElementsByTagName("a");if(0!==(tagsNodeList=[].filter.call(tagsNodeList,function(element){if(-1===element.className.indexOf(userOptions&&userOptions.ignoreClass))return dblTrigger?regex.test(element.getAttribute("bagDblClick")):regex.test(element.getAttribute("bagClick"))})).length){var gallery=[];let triggerMethod=dblTrigger?"dblclick":"click";[].forEach.call(tagsNodeList,function(imageElement,imageIndex){function imageElementClickHandler(event){event.preventDefault?event.preventDefault():event.returnValue=!1,prepareOverlay(gallery,userOptions),showOverlay(imageIndex)}var imageItem={eventHandler:imageElementClickHandler,imageElement:imageElement};!function(element,e,callBackForSingleClick,callbackForDoubleClick,options){if("dblclick"===e){let timeout,click=0;element.addEventListener("click",function(event){click++,clearTimeout(timeout),timeout=setTimeout(function(){1===click&&callBackForSingleClick(event),2===click&&callbackForDoubleClick(event),click=0},300)},options)}else"click"===e&&bind(element,"click",callbackForDoubleClick(element),options)}(imageElement,triggerMethod,singleClickCallBack,imageElementClickHandler),gallery.push(imageItem)}),selectorData.galleries.push(gallery)}}),selectorData.galleries}(selector,userOptions)},show:show,showNext:showNextImage,showPrevious:showPreviousImage,hide:hideOverlay,destroy:function(){var passiveEvent,nonPassiveEvent;passiveEvent=supports.passiveEvents?{passive:!1}:null,nonPassiveEvent=supports.passiveEvents?{passive:!0}:null,unbind(overlay,"click",overlayClickHandler),unbind(previousButton,"click",previousButtonClickHandler),unbind(nextButton,"click",nextButtonClickHandler),unbind(closeButton,"click",closeButtonClickHandler),unbind(slider,"contextmenu",contextmenuHandler),unbind(overlay,"touchstart",touchstartHandler,nonPassiveEvent),unbind(overlay,"touchmove",touchmoveHandler,passiveEvent),unbind(overlay,"touchend",touchendHandler),unbind(document,"focus",trapFocusInsideOverlay,!0),function(){for(var selector in data)data.hasOwnProperty(selector)&&removeFromCache(selector)}(),unbind(document,"keydown",keyDownHandler),document.getElementsByTagName("body")[0].removeChild(document.getElementById("baguetteBox-overlay")),data={},currentGallery=[],currentIndex=0}}});